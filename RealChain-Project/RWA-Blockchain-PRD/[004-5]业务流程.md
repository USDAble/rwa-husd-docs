# USDable Chain 开发需求文档 - 第 5 章: 业务流程

**文档编号**: [004-5]  
**文档版本**: v2.0  
**创建时间**: 2025-10-15 14:42 CST  
**更新时间**: 2025-10-15 15:55 CST  
**文档类型**: Product Requirements Document (PRD)  
**所属项目**: USDable Chain 全栈公链开发  

---

## 5.1 房东上链流程

### 5.1.1 流程概述

**参与方**:

-   房东 (Landlord)
-   资产节点 (Asset Node)
-   合规节点 (Compliance Node)
-   服务节点 (Service Node)
-   RWA Registry (资产注册表)
-   Compliance Guard (合规模块)

### 5.1.2 详细流程图

```mermaid
sequenceDiagram
    participant Issuer as 资产发行方
    participant KYC as KYC提供商
    participant Registry as IdentityRegistry
    participant Factory as AssetFactory
    participant Token as AssetToken
    participant Oracle as 估值预言机
    participant Investor as 投资者
    participant Compliance as ComplianceModule

    %% 第一阶段: KYC验证
    Note over Issuer,Registry: 阶段1: KYC验证 (1-3天)
    Issuer->>KYC: 1. 提交KYC资料
    KYC->>KYC: 2. 验证身份信息
    KYC->>Registry: 3. 注册身份
    Registry-->>KYC: 4. 注册成功
    KYC-->>Issuer: 5. KYC验证通过

    %% 第二阶段: 资产上链
    Note over Issuer,Token: 阶段2: 资产上链 (3-5天)
    Issuer->>Factory: 6. 创建资产代币
    Factory->>Factory: 7. 验证发行方权限
    Factory->>Token: 8. 部署AssetToken合约
    Token-->>Factory: 9. 返回代币地址
    Factory-->>Issuer: 10. 返回代币地址

    %% 第三阶段: 资产估值
    Note over Oracle,Token: 阶段3: 资产估值 (1-2天)
    Oracle->>Oracle: 11. 收集资产数据
    Oracle->>Token: 12. 更新资产估值
    Token-->>Oracle: 13. 估值更新成功

    %% 第四阶段: 投资者购买
    Note over Investor,Compliance: 阶段4: 投资者购买 (即时)
    Investor->>KYC: 14. 提交KYC资料
    KYC->>Registry: 15. 注册投资者身份
    Investor->>Compliance: 16. 尝试购买代币
    Compliance->>Registry: 17. 检查KYC状态
    Registry-->>Compliance: 18. 返回KYC状态
    Compliance->>Token: 19. 执行转账
    Token-->>Investor: 20. 转账成功
```

### 5.1.3 时间线

| 阶段       | 活动       | 预计时间 | 负责方     |
| ---------- | ---------- | -------- | ---------- |
| **阶段 1** | KYC 验证   | 1-3 天   | KYC 提供商 |
| **阶段 2** | 资产上链   | 3-5 天   | 资产发行方 |
| **阶段 3** | 资产估值   | 1-2 天   | 估值预言机 |
| **阶段 4** | 投资者购买 | 即时     | 投资者     |
| **总计**   | -          | 5-10 天  | -          |

---

## 5.2 跨链资产桥接流程

### 5.2.1 流程概述

**支持的目标链**:

-   Ethereum (Mainnet)
-   Binance Smart Chain (BSC)
-   Polygon (Matic)

### 5.2.2 详细流程图

```mermaid
sequenceDiagram
    participant User as 用户
    participant SourceBridge as 源链桥接合约
    participant Relayer as 跨链中继器
    participant TargetBridge as 目标链桥接合约
    participant Compliance as 合规模块

    %% 第一阶段: 锁定资产
    Note over User,SourceBridge: 阶段1: 锁定资产 (源链)
    User->>SourceBridge: 1. 发起桥接请求
    SourceBridge->>Compliance: 2. 验证合规
    Compliance-->>SourceBridge: 3. 合规检查通过
    SourceBridge->>SourceBridge: 4. 锁定资产
    SourceBridge->>Relayer: 5. 触发桥接事件

    %% 第二阶段: 跨链中继
    Note over Relayer: 阶段2: 跨链中继 (1-3分钟)
    Relayer->>Relayer: 6. 监听桥接事件
    Relayer->>Relayer: 7. 生成跨链证明
    Relayer->>TargetBridge: 8. 提交跨链证明

    %% 第三阶段: 释放资产
    Note over TargetBridge,User: 阶段3: 释放资产 (目标链)
    TargetBridge->>TargetBridge: 9. 验证跨链证明
    TargetBridge->>Compliance: 10. 验证合规
    Compliance-->>TargetBridge: 11. 合规检查通过
    TargetBridge->>TargetBridge: 12. 解锁资产
    TargetBridge->>User: 13. 转账给用户
    TargetBridge-->>Relayer: 14. 确认完成
    Relayer-->>SourceBridge: 15. 更新桥接状态
```

### 5.2.3 时间线

| 阶段       | 活动     | 预计时间 | 说明           |
| ---------- | -------- | -------- | -------------- |
| **阶段 1** | 锁定资产 | 2-6 秒   | 源链交易确认   |
| **阶段 2** | 跨链中继 | 1-3 分钟 | 中继器处理     |
| **阶段 3** | 释放资产 | 2-6 秒   | 目标链交易确认 |
| **总计**   | -        | 2-5 分钟 | -              |

---

## 5.3 结构化信贷投资流程

### 5.3.1 流程概述

**投资池结构**:

-   Senior Tranche (优先级): 目标 APY 8%
-   Junior Tranche (次级): 目标 APY 15%

### 5.3.2 详细流程图

```mermaid
sequenceDiagram
    participant Investor as 投资者
    participant KYC as KYC模块
    participant Pool as 投资池
    participant Asset as 底层资产
    participant Oracle as 估值预言机

    %% 第一阶段: 投资
    Note over Investor,Pool: 阶段1: 投资 (即时)
    Investor->>KYC: 1. 验证KYC状态
    KYC-->>Investor: 2. KYC验证通过
    Investor->>Pool: 3. 投资USDC
    Pool->>Pool: 4. 计算份额
    Pool-->>Investor: 5. 发放份额代币

    %% 第二阶段: 资产部署
    Note over Pool,Asset: 阶段2: 资产部署 (1-7天)
    Pool->>Asset: 6. 购买底层资产
    Asset-->>Pool: 7. 资产确认

    %% 第三阶段: 收益分配
    Note over Oracle,Investor: 阶段3: 收益分配 (每月)
    Oracle->>Pool: 8. 更新资产估值
    Pool->>Pool: 9. 计算NAV
    Pool->>Pool: 10. 分配收益
    Pool->>Investor: 11. Senior Tranche收益
    Pool->>Investor: 12. Junior Tranche收益

    %% 第四阶段: 赎回
    Note over Investor,Pool: 阶段4: 赎回 (1-7天)
    Investor->>Pool: 13. 发起赎回请求
    Pool->>Pool: 14. 计算赎回金额
    Pool->>Asset: 15. 出售底层资产
    Asset-->>Pool: 16. 返回USDC
    Pool->>Investor: 17. 转账USDC
```

### 5.3.3 收益分配规则

**分配顺序**:

1. **Senior Tranche**: 优先获得目标收益 (8% APY)
2. **Junior Tranche**: 获得剩余收益

**示例计算**:

```
假设:
- Senior Tranche投资: $1,000,000
- Junior Tranche投资: $500,000
- 总收益: $150,000 (年化10%)

分配:
1. Senior Tranche: $1,000,000 × 8% = $80,000
2. Junior Tranche: $150,000 - $80,000 = $70,000
   实际APY: $70,000 / $500,000 = 14%
```

---

## 5.4 DAO 治理流程

### 5.4.1 流程概述

**治理范围**:

-   协议参数调整 (Gas 费用、区块奖励等)
-   新功能提案
-   资金分配
-   紧急暂停

### 5.4.2 详细流程图

```mermaid
sequenceDiagram
    participant Proposer as 提案人
    participant Governor as 治理合约
    participant Timelock as 时间锁
    participant Voters as 投票者
    participant Target as 目标合约

    %% 第一阶段: 创建提案
    Note over Proposer,Governor: 阶段1: 创建提案 (即时)
    Proposer->>Governor: 1. 创建提案
    Governor->>Governor: 2. 验证提案人资格
    Governor-->>Proposer: 3. 提案创建成功

    %% 第二阶段: 投票
    Note over Voters,Governor: 阶段2: 投票 (7天)
    Voters->>Governor: 4. 投票 (赞成/反对/弃权)
    Governor->>Governor: 5. 记录投票

    %% 第三阶段: 执行
    Note over Governor,Target: 阶段3: 执行 (2天时间锁)
    Governor->>Governor: 6. 统计投票结果
    Governor->>Timelock: 7. 提交到时间锁
    Timelock->>Timelock: 8. 等待2天
    Timelock->>Target: 9. 执行提案
    Target-->>Timelock: 10. 执行成功
    Timelock-->>Governor: 11. 更新提案状态
```

### 5.4.3 投票规则

| 参数         | 数值        | 说明                     |
| ------------ | ----------- | ------------------------ |
| **提案门槛** | 100,000 RWA | 创建提案所需的最小代币数 |
| **投票周期** | 7 天        | 投票持续时间             |
| **法定人数** | 10%         | 最小投票参与率           |
| **通过阈值** | 51%         | 提案通过所需的赞成票比例 |
| **时间锁**   | 2 天        | 提案执行前的等待时间     |

---

## 5.5 合规监管流程

### 5.5.1 流程概述

**监管场景**:

-   强制转账 (法院命令)
-   资产冻结 (反洗钱)
-   KYC 撤销 (身份欺诈)

### 5.5.2 详细流程图

```mermaid
sequenceDiagram
    participant Regulator as 监管机构
    participant Compliance as 合规模块
    participant Registry as 身份注册表
    participant Token as 资产代币
    participant User as 用户

    %% 场景1: 强制转账
    Note over Regulator,User: 场景1: 强制转账
    Regulator->>Compliance: 1. 提交法院命令
    Compliance->>Compliance: 2. 验证监管机构权限
    Compliance->>Token: 3. 执行强制转账
    Token->>User: 4. 转账资产
    Token-->>Compliance: 5. 转账完成
    Compliance-->>Regulator: 6. 提交执行报告

    %% 场景2: 资产冻结
    Note over Regulator,User: 场景2: 资产冻结
    Regulator->>Compliance: 7. 发起冻结请求
    Compliance->>Token: 8. 冻结用户资产
    Token-->>Compliance: 9. 冻结成功
    Compliance-->>User: 10. 通知用户

    %% 场景3: KYC撤销
    Note over Regulator,User: 场景3: KYC撤销
    Regulator->>Registry: 11. 撤销KYC
    Registry->>Registry: 12. 更新身份状态
    Registry-->>User: 13. 通知用户
    User->>Token: 14. 尝试转账
    Token->>Compliance: 15. 检查KYC状态
    Compliance-->>Token: 16. KYC已撤销
    Token-->>User: 17. 转账失败
```

### 5.5.3 监管权限

| 监管机构          | 权限               | 说明         |
| ----------------- | ------------------ | ------------ |
| **SEC (美国)**    | 强制转账、资产冻结 | 证券监管     |
| **FinCEN (美国)** | 资产冻结、KYC 撤销 | 反洗钱监管   |
| **MAS (新加坡)**  | 强制转账、资产冻结 | 金融监管     |
| **FCA (英国)**    | 强制转账、资产冻结 | 金融行为监管 |

---

## 5.6 数据验证流程

### 5.6.1 流程概述

**验证方式**: zkTLS + 多数据源验证

**数据类型**:

-   资产估值数据
-   财务报表数据
-   合规证明数据

### 5.6.2 详细流程图

```mermaid
sequenceDiagram
    participant Provider1 as 数据提供者1
    participant Provider2 as 数据提供者2
    participant Provider3 as 数据提供者3
    participant Verifier as 数据验证器
    participant Asset as 资产代币

    %% 第一阶段: 数据提交
    Note over Provider1,Verifier: 阶段1: 数据提交
    Provider1->>Verifier: 1. 提交数据证明
    Provider2->>Verifier: 2. 提交数据证明
    Provider3->>Verifier: 3. 提交数据证明

    %% 第二阶段: 数据验证
    Note over Verifier: 阶段2: 数据验证
    Verifier->>Verifier: 4. 验证zkTLS证明
    Verifier->>Verifier: 5. 比对数据一致性
    Verifier->>Verifier: 6. 达到最小确认数 (3)

    %% 第三阶段: 数据应用
    Note over Verifier,Asset: 阶段3: 数据应用
    Verifier->>Asset: 7. 更新资产数据
    Asset-->>Verifier: 8. 更新成功
    Verifier->>Provider1: 9. 分发奖励
    Verifier->>Provider2: 10. 分发奖励
    Verifier->>Provider3: 11. 分发奖励
```

### 5.6.3 验证标准

| 标准           | 要求   | 说明                      |
| -------------- | ------ | ------------------------- |
| **最小确认数** | 3      | 至少 3 个独立数据源       |
| **数据一致性** | 95%+   | 数据源间的一致性阈值      |
| **验证超时**   | 5 分钟 | 数据验证的超时时间        |
| **zkTLS 证明** | 必须   | 所有数据必须有 zkTLS 证明 |

---

**文档完成**

**上一章节**: [004-4]技术规格.md  
**下一章节**: [004-6]合规与安全.md  
**返回主索引**: [004]RWA 公链开发需求文档-主索引.md

**版权声明**: 本文档仅供内部使用,未经授权不得外传。
