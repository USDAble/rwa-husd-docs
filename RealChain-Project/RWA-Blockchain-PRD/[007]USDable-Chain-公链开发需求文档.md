# USDable Chain 公链开发需求文档

**文档编号**: [007]  
**文档版本**: v1.0  
**创建时间**: 2025-10-15  
**文档类型**: 公链开发需求文档  
**所属项目**: USDable Chain 全栈公链开发  
**参考架构**: Plume Network

---

## 目录

- [1. 总体设计原则](#1-总体设计原则)
- [2. 核心功能模块](#2-核心功能模块)
- [3. 基础设施模块](#3-基础设施模块)
- [4. 安全与合规模块](#4-安全与合规模块)
- [5. 运维与监控模块](#5-运维与监控模块)
- [6. 对外接口规范](#6-对外接口规范)

---

## 1. 总体设计原则

### 1.1 核心理念

USDable Chain 是一条**面向真实资产 (RWA) 的金融级公链**,围绕**可信、可审计、可扩展、可监管**四大核心原则构建。

### 1.2 技术准则

1. **EVM 完全兼容**: 支持 Solidity 智能合约、以太坊 ABI、eth_* RPC 接口,Gas 代币为 ABLE
2. **高性能共识**: 3-5 秒出块时间,最终性 ≤ 2 个区块,目标 TPS ≥ 5,000
3. **模块化架构**: 共识、执行、数据、跨链、预言机、合规模块可热插拔升级
4. **全程可审计**: 所有关键操作 (铸币、分红、跨链、喂价、治理) 均可链上审计
5. **SRE 先行**: 服务等级目标 (SLO)、灰度发布、回滚机制、容量规划、压力测试与代码同步上线

### 1.3 差异化定位

- **专注房地产 RWA**: 提供从资产上链到分红的完整垂直解决方案
- **自动化分红系统**: 内置租金分红自动分配机制
- **四类业务节点**: 资产节点、合规节点、服务节点、推广节点形成完整生态
- **veABLE 治理**: 锁仓时间越长投票权越大,激励长期持有

---

## 2. 核心功能模块

### 2.1 钱包系统

**目标**: 让 C 端投资人和 B 端发行人零摩擦接入链、签名和收分红。

**功能需求**:

1. **用户端钱包**
   - 完全兼容 MetaMask、WalletConnect、Ledger 等主流钱包
   - 支持 RWA 资产卡片展示 (资产元数据、分红日历、法律文件哈希、节点签章)
   - 自动校验受限转让规则 (ERC-3643/T-REX 白名单)
   - 地区/合规风险提示

2. **产业端钱包**
   - MPC 托管钱包 (类似 Fireblocks)
   - 多签钱包 (基金会/节点/律所 2/3 签名)
   - 分红批量领取优化

**性能要求**:
- 连接成功率 ≥ 99.9%
- 签名往返延迟 < 400ms (同区域)
- 私钥从不落地,MPC + 风险限额 (24h 出金白名单/二次确认)

**优先级**: P0 (MVP 必须)

---

### 2.2 RPC 节点

**目标**: 提供稳定、可观测、可弹性的公共网关和专业网关,支撑交易所/浏览器/应用高并发。

**功能需求**:

1. **多域名入口**
   - 公共 RPC (限频)
   - 专业 RPC (KYC + 高配 + 付费)

2. **读写分离**
   - Archive/Full/Light 节点分层
   - 交易写入专网,查询走只读池

3. **限流与防滥用**
   - IP/账户级 QPS 限制
   - 爆破/MEV 保护
   - 动态 ban 机制

4. **索引加速**
   - 与 Indexer (The Graph/自研) 打通
   - 复杂查询走 GraphQL

**性能要求**:
- p95 延迟 < 150ms
- 可用性 ≥ 99.95%
- 每秒 ≥ 10k 请求
- WAF + mTLS (专业网关)
- 大促自动扩容 (HPA)

**优先级**: P0

---

### 2.3 区块链浏览器

**目标**: 把"可验证"做到极致,让监管/投资人"一眼信任"。

**功能需求**:

1. **三层视图**
   - 区块/交易/账户基础视图
   - RWA 资产页 (产权文件哈希、节点签章、分红记录、估值喂价轨迹)

2. **地图可视化**
   - 节点地理分布
   - RWA 资产地区热力图

3. **监管模式**
   - 可筛选受限交易
   - KYC 白名单检查
   - 洗钱风险标签 (只展示级别,不展示隐私)

4. **数据导出**
   - CSV/JSON 格式导出
   - 审计 API (时间窗 + 合约集)

**性能要求**:
- 全量索引 < 24h
- 增量延迟 < 2s
- 查询 p95 < 300ms
- 结果可重算 (Deterministic),审计校验和

**优先级**: P0

---

### 2.4 算力设备 (节点系统)

**目标**: 全球多点、低延迟、抗故障;AI 风控与合规模块原生上链服务。

**功能需求**:

1. **节点类型**
   - **Validator (验证节点)**: 裸金属 + HSM/TEE 安全芯片
   - **Service (服务节点)**: Oracle/合规模块执行
   - **Archive (归档节点)**: 长期存储 + 快照

2. **安全芯片**
   - HSM 或 SGX/TEE 用于出块/签名与密钥封装

3. **AI 风控**
   - OCR/NLP 合规审查
   - 异常交易检测 (流式特征)
   - 以"风险分数"上链

**性能要求**:
- 出块节点地理冗余 (≥3 区)
- 灾备 RPO=0,RTO < 15min
- 节点在线 ≥ 99.5%
- 对等网络抗 DDoS,启用 QUIC/TLS

**优先级**: P1 (随主网扩大)

---

### 2.5 Token 标准

**目标**: 统一、可组合、合规可控。

**功能需求**:

1. **RWA 合规代币** (基于 ERC-3643/T-REX 扩展)
   - 受限转让 (Transfer Hook: KYC/地域/黑名单/锁定期)
   - 强制赎回/回收 (法律事件触发)
   - 分红快照 (快照块 + Merkle 分发)
   - 资产元数据 (法律文件哈希、估值、节点签章)

2. **治理代币 ABLE**
   - EIP-20 标准
   - EIP-2612 (permit 授权)
   - 治理模块 (投票/提案/锁仓)

3. **索引与披露**
   - Token Metadata 标准化 (schema + IPFS/Arweave)

**安全要求**:
- 合约覆盖率 ≥ 95%
- 双审计 + 形式化验证关键函数 (transfer hooks、redeem)

**优先级**: P0

---

### 2.6 DEX (去中心化交易所)

**目标**: 让小众 RWA 也有成交深度。

**功能需求**:

1. **混合架构**
   - 撮合优先 + AMM 兜底
   - CLOB (价/时优先) + v2/v3 Pool
   - 统一深度视图

2. **RWA 保护**
   - 默认价带/熔断机制
   - 集合竞价首发
   - 滑点保护与交易白名单 (合规地理限制)

3. **流动性管理**
   - 官方 LP 锁仓
   - 做市任务 (靠 ABLE 激励 + 罚没条款)

**性能要求**:
- 撮合内核延迟 < 100µs
- 端到端延迟 < 200ms
- 反自成交/洪水挂单防护

**优先级**: P0

---

### 2.7 预言机 (Oracle)

**目标**: 喂价可信,支持价格、估值、法律事件三类数据。

**功能需求**:

1. **多源签名**
   - ≥3 个数据源
   - 价格 + 估值 + 法律事件三类喂价

2. **聚合算法**
   - 中位数 + 偏差剔除 (MAD/σ 阈值)
   - 延时确认防闪电贷

3. **法律事件喂价**
   - 过户/抵押/违约 → 触发合约回购/冻结/强清

**性能要求**:
- 喂价窗口 30s-300s
- 异常自动降级
- 签名轮值,喂价审计链上可查

**优先级**: P0

---

### 2.8 跨链桥 (Bridge)

**目标**: 跨链安全,仅跨链到有合规模块的目的链。

**功能需求**:

1. **轻客户端优先**
   - IBC/LC 协议
   - 若用多签桥 → M-of-N + TEE + 保险池

2. **资产映射**
   - RWA 仅跨链到有合规模块的目的链 (白名单链)

3. **监控机制**
   - Proof 延迟/合约重放/阈值变更均需链上治理

**性能要求**:
- 转移确认 < 5min (LC)
- 多签桥需 24/7 监控与自动熔断

**优先级**: P1

---

## 3. 基础设施模块

### 3.1 SaaS 上链 (发行人后台)

**目标**: 24 小时内完成从资料齐全到可交易的全流程。

**功能需求**:

1. **上链流程**
   - 文件上传 → AI 审核 → 节点签章 → 铸币 → 上架交易 → 分红日历

2. **API 接口**
   - Webhook 回调
   - 错误显式提示
   - 状态机可回放

**性能要求**:
- 24h 上链 SLO: 从资料齐全到可交易 ≤ 24h

**优先级**: P0 (与 RWA 强绑定)

---

### 3.2 合规/KYC/AML

**目标**: 满足全球监管要求。

**功能需求**:

1. **身份验证**
   - KYC 身份验证
   - 制裁名单检查
   - 交易模式检测 (KYT)

2. **转账拦截**
   - Transfer Hook 拦截不合规交易

3. **监管接口**
   - 监管只读密钥
   - 可导出交易与资产快照

**优先级**: P0

---

## 4. 安全与合规模块

### 4.1 安全底线

1. **合约安全**
   - 双审计 + 关键模块形式化验证 (桥、预言机、受限转让)

2. **密钥管理**
   - HSM/MPC
   - 离线备份分层密封
   - 提币/桥转多岗审批

3. **数据安全**
   - PII 加密
   - 最小化收集
   - 合规地域强约束 (合约层校验)

4. **事件响应**
   - P1 事件 15 分钟内公告
   - 72 小时根因报告 (RCA)

5. **保险与储备**
   - RWA 安全基金 (≥ 5% 手续费沉淀)
   - 桥黑天鹅保险池

**优先级**: P0 (不可妥协项)

---

## 5. 运维与监控模块

### 5.1 观测/SRE

**功能需求**:

1. **四大看板**
   - 链 (TPS/延迟/出块漂移)
   - DEX (深度/点差)
   - 预言机 (喂价偏差)
   - 桥 (队列与失败率)

2. **灰度与回滚**
   - 灰度开关
   - 特性旗标 (Feature Flags)
   - 一键回滚

3. **压测基线**
   - 合约/撮合/索引各自独立压测套件

**优先级**: P0

---

## 6. 对外接口规范

### 6.1 公共接口

- RPC/WebSocket
- GraphQL Index
- Explorer REST API

### 6.2 企业接口

- SaaS 上链 API
- 分红对账 API
- 合规审计 API
- 监控与告警 Webhook

### 6.3 事件总线

Kafka topic 标准:
- `tx.new` (新交易)
- `dividend.settled` (分红结算)
- `oracle.update` (预言机更新)
- `bridge.finalized` (跨链完成)

### 6.4 Schema 版本化

- AssetMeta v1→v2 兼容策略
- Deprecation 日历

---

## 附录: 优先级说明

- **P0 (MVP 必须)**: 钱包、RPC、浏览器、Token 标准、DEX、预言机、SaaS 上链、合规/KYC、安全、SRE
- **P1 (随主网扩大)**: 算力设备、跨链桥

---

**文档结束**

